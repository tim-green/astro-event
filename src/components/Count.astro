---
import { getEventData } from "../data/eventData";

const { countdown } = getEventData();
const eventDate = countdown.target;
const eventLabel = countdown.label;
const eventHeading = countdown.heading;
const eventMessage = countdown.message;
const eventLocation = countdown.location;
---

<section
    class="py-24 px-6"
    style="
        background-color: var(--color-background);
        color: var(--color-accent);
    "
>
    <div
        class="mx-auto flex w-full max-w-5xl flex-col items-center gap-12 text-center"
    >
        <p
            class="text-xs uppercase tracking-[0.5em]"
            style="color: var(--color-accent);"
        >
            {eventLabel}
        </p>

        <h2
            class="font-display text-[clamp(2.5rem,6vw,4.5rem)] uppercase leading-tight"
            style="color: var(--color-primary);"
        >
            {eventHeading}
        </h2>

        <p
            class="max-w-2xl text-base sm:text-lg"
            style="color: var(--color-text); opacity: 0.75;"
        >
            {eventMessage}
        </p>

        <div
            class="grid w-full gap-4 sm:grid-cols-2 lg:grid-cols-4"
            data-countdown
            data-countdown-target={eventDate}
        >
            <div
                class="rounded-3xl border px-6 py-8"
                style="
                    border-color: var(--color-accent);
                    background: color-mix(in srgb, var(--color-background) 60%, transparent);
                "
            >
                <p
                    class="text-sm uppercase tracking-[0.35em]"
                    style="color: var(--color-accent);"
                >
                    Days
                </p>
                <p
                    class="font-display text-5xl sm:text-6xl"
                    style="color: var(--color-primary);"
                    data-days
                >
                    --
                </p>
            </div>
            <div
                class="rounded-3xl border px-6 py-8"
                style="
                    border-color: var(--color-accent);
                    background: color-mix(in srgb, var(--color-background) 60%, transparent);
                "
            >
                <p
                    class="text-sm uppercase tracking-[0.35em]"
                    style="color: var(--color-accent);"
                >
                    Hours
                </p>
                <p
                    class="font-display text-5xl sm:text-6xl"
                    style="color: var(--color-primary);"
                    data-hours
                >
                    --
                </p>
            </div>
            <div
                class="rounded-3xl border px-6 py-8"
                style="
                    border-color: var(--color-accent);
                    background: color-mix(in srgb, var(--color-background) 60%, transparent);
                "
            >
                <p
                    class="text-sm uppercase tracking-[0.35em]"
                    style="color: var(--color-accent);"
                >
                    Minutes
                </p>
                <p
                    class="font-display text-5xl sm:text-6xl"
                    style="color: var(--color-primary);"
                    data-minutes
                >
                    --
                </p>
            </div>
            <div
                class="rounded-3xl border px-6 py-8"
                style="
                    border-color: var(--color-accent);
                    background: color-mix(in srgb, var(--color-background) 60%, transparent);
                "
            >
                <p
                    class="text-sm uppercase tracking-[0.35em]"
                    style="color: var(--color-accent);"
                >
                    Seconds
                </p>
                <p
                    class="font-display text-5xl sm:text-6xl"
                    style="color: var(--color-primary);"
                    data-seconds
                >
                    --
                </p>
            </div>
        </div>

        <div
            class="text-sm uppercase tracking-[0.35em]"
            style="color: var(--color-accent);"
        >
            {eventLocation}
        </div>
    </div>
</section>

<script type="module">
    const initCountdown = () => {
        const root = document.querySelector("[data-countdown]");
        if (!root) {
            return;
        }

        const targetDate = root.dataset.countdownTarget;
        if (!targetDate) {
            return;
        }

        const pad = (value) => String(value).padStart(2, "0");
        const targets = {
            days: root.querySelector("[data-days]"),
            hours: root.querySelector("[data-hours]"),
            minutes: root.querySelector("[data-minutes]"),
            seconds: root.querySelector("[data-seconds]"),
        };

        let timer;

        const updateCountdown = () => {
            const now = Date.now();
            const eventTime = new Date(targetDate).getTime();
            const remaining = Math.max(eventTime - now, 0);

            const seconds = Math.floor(remaining / 1000);
            const days = Math.floor(seconds / 86400);
            const hours = Math.floor((seconds % 86400) / 3600);
            const minutes = Math.floor((seconds % 3600) / 60);
            const secs = seconds % 60;

            if (targets.days) targets.days.textContent = pad(days);
            if (targets.hours) targets.hours.textContent = pad(hours);
            if (targets.minutes) targets.minutes.textContent = pad(minutes);
            if (targets.seconds) targets.seconds.textContent = pad(secs);

            if (remaining <= 0) {
                clearInterval(timer);
            }
        };

        updateCountdown();
        timer = setInterval(updateCountdown, 1000);
    };

    initCountdown();
</script>
